var ShBg=function(){var e="shbg",t="infobox",n="image",o="through",r="/static/image/background/",a=0,c=5,i=0,d=0,u=localStorage.SayHanabiBg||i,l=localStorage.SayHanabiBgTrans||d,s=r+u+".jpg",m=r+u+"_dim.jpg",g=(document.createElement("P"),[[["forum","thread","home::spacecp","home::task","home::medal","home::magic","portal","userapp","cp","search","plugin"],["bm_c","pl","ct2_a","ct1","frame"]],[["group","dsu_paulsign","plugin"],["ct2"]],[["member"],["bm"]],[["home::space","home::follow","misc","space"],["ct2_a","ct1"]],[["home"],["ct3_a"]],[["forum"],["frame-tab"]],[["portal"],["tb-c"]],[["misc::mobile"],["ptw"]]]),h=[{user:"秋之溯源",source:"魔女恋爱日记",id:3340},{user:"「緋雪夜櫻」",source:"eden* They were only two, on the planet",id:3147},{user:"DracuRiot",source:"clover days",id:10033},{user:"孤影流觞",source:"RE:从零开始的异世界生活",id:6498},{user:"殘鳯雾雨",source:"近月少女的礼仪",id:8285}],p=function(){if(!a){a=1;try{document.getElementById(e+"-"+t).innerHTML=b()}catch(n){}}},f=function(){if(a){a=0;try{document.getElementById(e+"-"+t).innerHTML=b()}catch(n){}}},b=function(){var e=h[u].source+'，由<a href="/space-uid-'+h[u].id+'.html"> '+h[u].user+" </a>推荐";return 1==a?"正在载入"+e:e},y=function(){document.body.removeAttribute("style"),document.body.style.backgroundImage="url("+s+")",document.body.style.backgroundSize="cover",document.body.style.backgroundRepeat="no-repeat",document.body.style.backgroundPosition="center center",document.body.style.backgroundAttachment="fixed",document.body.style.backgroundSize="cover",0==l&&f()},v=function(){for(var e=0;e<g.length;++e)for(var t=0;t<g[e][0].length;++t)if(g[e][0][t]==B||g[e][0][t]==H)for(var n=0;n<g[e][1].length;++n)for(var o=document.getElementsByClassName(g[e][1][n]),r=0;r<o.length;++r)o[r].removeAttribute("style"),o[r].style.backgroundImage="url("+m+")",o[r].style.backgroundSize="cover",o[r].style.backgroundRepeat="no-repeat",o[r].style.backgroundPosition="center center",o[r].style.backgroundAttachment="fixed",o[r].style.boxShadow="2px 2px 15px #929292";f()},k=function(){for(var e=0;e<g.length;++e)for(var t=0;t<g[e][0].length;t++)if(g[e][0][t]==B||g[e][0][t]==H)for(var n=0;n<g[e][1].length;n++)for(var o=document.getElementsByClassName(g[e][1][n]),r=0;r<o.length;r++)o[r].removeAttribute("style"),o[r].style.boxShadow="2px 2px 15px #929292",o[r].style.backgroundColor="white";f()},S=function(){y(),1==l&&v()},w=function(){1==l?v():k()},x=function(e){if(e!=u&&1!=a){p(),u=e;var t=new Image,n=new Image;s=r+e+".jpg",m=r+e+"_dim.jpg",t.onload=S,n.src=m,t.src=s,localStorage.SayHanabiBg=e}},E=function(e){if(e!=l&&1!=a){if(p(),l=e,1==e){var t=new Image;m=r+u+"_dim.jpg",t.onload=w,t.src=m}else w();localStorage.SayHanabiBgTrans=e}},C=function(e){var t=e.indexOf(".php");return-1!==t?e.substring(1,t):e.substring(1,e.indexOf("-"))},A=function(e){var t=e.split("mod=");if(1!==t.length){var n=t[1].indexOf("&");return-1!==n?t[1].substring(0,n):t[1]}return void 0},L=function(){var e=window.location.pathname,t=window.location.search,n=C(e),o=A(t);return o=o?"::"+o:"",n+o},B=L(),H=B.substring(0,B.indexOf("::"));this.phase1=function(){var e=new Image;e.onload=y,e.src=s,p()},this.phase2=function(){if(1==l){var e=new Image;e.onload=v,e.src=m}else k()},document.addEventListener("DOMContentLoaded",function(){var r=document.getElementById("um");if(!r)return!1;var a,i,d=document.createElement("A"),u=document.createElement("SPAN"),l=document.createElement("P"),s=document.createElement("P"),m=document.createElement("P");l.id=e+"-"+t,l.innerHTML=b(),d.href="javascript:void(0);",u.innerHTML="|",u.setAttribute("class","pipe"),a=d.cloneNode(),i=d.cloneNode();for(var g=0;c-1>=g;++g){var h=d.cloneNode();h.setAttribute("data-"+e+"-"+n,g),h.innerHTML="背景"+g,h.addEventListener("click",function(){x(this.getAttribute("data-"+e+"-"+n))}),s.appendChild(h),s.appendChild(u.cloneNode(!0))}s.removeChild(s.lastChild),a.innerHTML="透明",a.setAttribute("data-"+e+"-"+o,1),a.addEventListener("click",function(){E(1)}),i.innerHTML="不透明",i.setAttribute("data-"+e+"-"+o,0),i.addEventListener("click",function(){E(0)}),m.appendChild(a),m.appendChild(u.cloneNode(!0)),m.appendChild(i),r.appendChild(l),r.appendChild(s),r.appendChild(m)})},shbgInstance=new ShBg;
